---
// Navbar component - converted from React to Astro with vanilla JS for interactivity
---

<nav class="fixed top-0 left-0 right-0 bg-white shadow-md z-50">
  <div class="container mx-auto px-4">
    <div class="flex justify-between items-center h-[70px]">
      <a href="/" class="flex-shrink-0">
        <img src="/images/logos/CompanyNameAndLogo.svg" alt="Pensionable.ai" class="h-[40px]" />
      </a>

      <!-- Desktop Navigation -->
      <div class="hidden md:flex">
        <div class="nav-dropdown relative py-2 px-4 flex-shrink-0" data-dropdown="burningIssues">
          <span class="text-lg cursor-pointer hover:text-teal">Industry Issues</span>
          <div class="dropdown-menu absolute top-[calc(100%-4px)] left-0 w-64 bg-white shadow-lg rounded-md py-2 z-50 hidden">
            <a href="/defined-benefit-prt" class="block px-4 py-2 text-gray-800 hover:bg-gray-100 hover:text-teal">Defined Benefit PRT</a>
            <a href="/isp-value-data" class="block px-4 py-2 text-gray-800 hover:bg-gray-100 hover:text-teal">ISP Value Data</a>
            <a href="/gmp-rectification" class="block px-4 py-2 text-gray-800 hover:bg-gray-100 hover:text-teal">GMP Rectification</a>
          </div>
        </div>

        <div class="nav-dropdown relative py-2 px-4 flex-shrink-0" data-dropdown="stakeholders">
          <a href="/stakeholder-perspective" class="text-lg hover:text-teal">Stakeholder Perspective</a>
          <div class="dropdown-menu absolute top-[calc(100%-4px)] left-0 w-64 bg-white shadow-lg rounded-md py-2 z-50 hidden">
            <a href="/stakeholder-perspective#stakeholder-1" class="block px-4 py-2 text-gray-800 hover:bg-gray-100 hover:text-teal">Pension Scheme Trustees</a>
            <a href="/stakeholder-perspective#stakeholder-2" class="block px-4 py-2 text-gray-800 hover:bg-gray-100 hover:text-teal">Pension Scheme Administrators</a>
            <a href="/stakeholder-perspective#stakeholder-3" class="block px-4 py-2 text-gray-800 hover:bg-gray-100 hover:text-teal">Insurance Companies</a>
            <a href="/stakeholder-perspective#stakeholder-4" class="block px-4 py-2 text-gray-800 hover:bg-gray-100 hover:text-teal">Pension System Providers</a>
          </div>
        </div>

        <div class="nav-dropdown relative py-2 px-4 flex-shrink-0" data-dropdown="solutions">
          <a href="/solutions" class="text-lg hover:text-teal">Solution Components</a>
          <div class="dropdown-menu absolute top-[calc(100%-4px)] left-0 w-64 bg-white shadow-lg rounded-md py-2 z-50 hidden">
            <a href="/solutions#logic-etl" class="block px-4 py-2 text-gray-800 hover:bg-gray-100 hover:text-teal">Logic ETL</a>
            <a href="/solutions#data-etl" class="block px-4 py-2 text-gray-800 hover:bg-gray-100 hover:text-teal">Data ETL</a>
            <a href="/solutions#analytics" class="block px-4 py-2 text-gray-800 hover:bg-gray-100 hover:text-teal">Analytics</a>
            <a href="/solutions#integration" class="block px-4 py-2 text-gray-800 hover:bg-gray-100 hover:text-teal">Integration</a>
            <a href="/solutions#consulting" class="block px-4 py-2 text-gray-800 hover:bg-gray-100 hover:text-teal">Consulting</a>
          </div>
        </div>

        <div class="nav-dropdown relative py-2 px-4 flex-shrink-0" data-dropdown="technology">
          <a href="/technology" class="text-lg hover:text-teal">Technology</a>
          <div class="dropdown-menu absolute top-[calc(100%-4px)] left-0 w-64 bg-white shadow-lg rounded-md py-2 z-50 hidden">
            <a href="/technology#approach" class="block px-4 py-2 text-gray-800 hover:bg-gray-100 hover:text-teal">Our Approach</a>
            <a href="/technology#agent-fleet" class="block px-4 py-2 text-gray-800 hover:bg-gray-100 hover:text-teal">Agent Fleet</a>
            <a href="/technology#ai-capabilities" class="block px-4 py-2 text-gray-800 hover:bg-gray-100 hover:text-teal">AI Capabilities</a>
            <a href="/technology#partners" class="block px-4 py-2 text-gray-800 hover:bg-gray-100 hover:text-teal">Partners</a>
            <a href="/technology#security" class="block px-4 py-2 text-gray-800 hover:bg-gray-100 hover:text-teal">Security</a>
          </div>
        </div>

        <div class="relative py-2 px-4 flex-shrink-0">
          <a href="/team" class="text-lg hover:text-teal">Team</a>
        </div>

        <div class="relative py-2 px-4 flex-shrink-0">
          <a href="/contact" class="text-lg hover:text-teal">Contact</a>
        </div>
      </div>

      <!-- Mobile Menu Button -->
      <button id="mobile-menu-btn" class="md:hidden" aria-label="Toggle mobile menu">
        <svg class="w-7 h-7" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16" />
        </svg>
      </button>
    </div>

    <!-- Mobile Menu -->
    <div id="mobile-menu" class="md:hidden py-4 border-t border-gray-200 hidden">
      <div class="space-y-2">
        <div>
          <button class="mobile-section-toggle w-full flex justify-between items-center px-4 py-2 text-lg hover:text-teal" data-section="burningIssues">
            Industry Issues
            <svg class="w-4 h-4 transform transition-transform" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />
            </svg>
          </button>
          <div class="mobile-section-content hidden bg-gray-50 py-2" data-content="burningIssues">
            <a href="/defined-benefit-prt" class="block px-8 py-2 text-gray-800 hover:text-teal">Defined Benefit PRT</a>
            <a href="/isp-value-data" class="block px-8 py-2 text-gray-800 hover:text-teal">ISP Value Data</a>
            <a href="/gmp-rectification" class="block px-8 py-2 text-gray-800 hover:text-teal">GMP Rectification</a>
          </div>
        </div>

        <div>
          <button class="mobile-section-toggle w-full flex justify-between items-center px-4 py-2 text-lg hover:text-teal" data-section="stakeholders">
            Stakeholder Perspective
            <svg class="w-4 h-4 transform transition-transform" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />
            </svg>
          </button>
          <div class="mobile-section-content hidden bg-gray-50 py-2" data-content="stakeholders">
            <a href="/stakeholder-perspective#stakeholder-1" class="block px-8 py-2 text-gray-800 hover:text-teal">Pension Scheme Trustees</a>
            <a href="/stakeholder-perspective#stakeholder-2" class="block px-8 py-2 text-gray-800 hover:text-teal">Pension Scheme Administrators</a>
            <a href="/stakeholder-perspective#stakeholder-3" class="block px-8 py-2 text-gray-800 hover:text-teal">Insurance Companies</a>
            <a href="/stakeholder-perspective#stakeholder-4" class="block px-8 py-2 text-gray-800 hover:text-teal">Pension System Providers</a>
          </div>
        </div>

        <div>
          <button class="mobile-section-toggle w-full flex justify-between items-center px-4 py-2 text-lg hover:text-teal" data-section="solutions">
            Solution Components
            <svg class="w-4 h-4 transform transition-transform" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />
            </svg>
          </button>
          <div class="mobile-section-content hidden bg-gray-50 py-2" data-content="solutions">
            <a href="/solutions#logic-etl" class="block px-8 py-2 text-gray-800 hover:text-teal">Logic ETL</a>
            <a href="/solutions#data-etl" class="block px-8 py-2 text-gray-800 hover:text-teal">Data ETL</a>
            <a href="/solutions#analytics" class="block px-8 py-2 text-gray-800 hover:text-teal">Analytics</a>
            <a href="/solutions#integration" class="block px-8 py-2 text-gray-800 hover:text-teal">Integration</a>
            <a href="/solutions#consulting" class="block px-8 py-2 text-gray-800 hover:text-teal">Consulting</a>
          </div>
        </div>

        <div>
          <button class="mobile-section-toggle w-full flex justify-between items-center px-4 py-2 text-lg hover:text-teal" data-section="technology">
            Technology
            <svg class="w-4 h-4 transform transition-transform" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />
            </svg>
          </button>
          <div class="mobile-section-content hidden bg-gray-50 py-2" data-content="technology">
            <a href="/technology#approach" class="block px-8 py-2 text-gray-800 hover:text-teal">Our Approach</a>
            <a href="/technology#agent-fleet" class="block px-8 py-2 text-gray-800 hover:text-teal">Agent Fleet</a>
            <a href="/technology#ai-capabilities" class="block px-8 py-2 text-gray-800 hover:text-teal">AI Capabilities</a>
            <a href="/technology#partners" class="block px-8 py-2 text-gray-800 hover:text-teal">Partners</a>
            <a href="/technology#security" class="block px-8 py-2 text-gray-800 hover:text-teal">Security</a>
          </div>
        </div>

        <a href="/team" class="block px-4 py-2 text-lg hover:text-teal">Team</a>
        <a href="/contact" class="block px-4 py-2 text-lg hover:text-teal">Contact</a>
      </div>
    </div>
  </div>
</nav>

<script>
  // Mobile menu toggle
  const mobileMenuBtn = document.getElementById('mobile-menu-btn');
  const mobileMenu = document.getElementById('mobile-menu');

  mobileMenuBtn?.addEventListener('click', () => {
    mobileMenu?.classList.toggle('hidden');
  });

  // Mobile section toggles
  document.querySelectorAll('.mobile-section-toggle').forEach(btn => {
    btn.addEventListener('click', () => {
      const section = btn.getAttribute('data-section');
      const content = document.querySelector(`[data-content="${section}"]`);
      const arrow = btn.querySelector('svg');
      content?.classList.toggle('hidden');
      arrow?.classList.toggle('rotate-180');
    });
  });

  // Desktop dropdown hover
  let closeTimeout: ReturnType<typeof setTimeout>;

  document.querySelectorAll('.nav-dropdown').forEach(dropdown => {
    const menu = dropdown.querySelector('.dropdown-menu');

    dropdown.addEventListener('mouseenter', () => {
      clearTimeout(closeTimeout);
      // Close all other dropdowns
      document.querySelectorAll('.dropdown-menu').forEach(m => {
        if (m !== menu) m.classList.add('hidden');
      });
      menu?.classList.remove('hidden');
    });

    dropdown.addEventListener('mouseleave', () => {
      closeTimeout = setTimeout(() => {
        menu?.classList.add('hidden');
      }, 150);
    });
  });

  // Close mobile menu on link click
  mobileMenu?.querySelectorAll('a').forEach(link => {
    link.addEventListener('click', () => {
      mobileMenu?.classList.add('hidden');
    });
  });

  // Handle hash scrolling on page load
  if (window.location.hash) {
    setTimeout(() => {
      const el = document.getElementById(window.location.hash.slice(1));
      if (el) {
        el.scrollIntoView({ behavior: 'smooth' });
      }
    }, 300);
  }
</script>
